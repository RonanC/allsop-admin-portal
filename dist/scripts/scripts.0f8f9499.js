"use strict";angular.module("allsop",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.sortable","LocalStorageModule","720kb.datepicker"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/auctions",{templateUrl:"views/auctions.html",controller:"AuctionsCtrl",controllerAs:"auctions"}).when("/notify",{templateUrl:"views/notify.html",controller:"NotifyCtrl",controllerAs:"notify"}).otherwise({redirectTo:"/"})}]),angular.module("allsop").controller("MainCtrl",["$scope","localStorageService",function(a,b){var c=this,d=b.get("todos");c.todos=d||[],a.$watch("main.todos",function(){b.set("todos",c.todos)},!0),c.addTodo=function(){-1===c.todos.indexOf(c.todo)&&(c.todos.push(c.todo),c.todo="")},c.removeTodo=function(a){c.todos.splice(a,1)}}]),angular.module("allsop").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),function(){function a(a,b,c,d){function e(a){var b=a+":00 GMT+0000 (GMT)",c=new Date(b),d=Number(c),e=d.toString();return e}function f(){function a(){g.auctionTitles=[],g.auctionEntries=[],h.allDocs({include_docs:!0,descending:!0},function(a,c){console.log("DB Change, updating list..."),b(c.rows)})}function b(a){a.forEach(function(a){"_"!==a.id.charAt(0)&&(g.auctionTitles.push(a.doc.where),a.doc.when=e(a.doc._id),g.auctionEntries.push(a.doc))}),console.log(g.auctionEntries),c(function(){d.$apply()})}function e(a){var b=new Date(parseInt(a)),c=b.toString().slice(0,21);return c}var f={live:!0};h.replicate.to(i,f),h.replicate.from(i,f),a(),h.changes({since:"now",live:!0}).on("change",a)}var g=this;g.auctionTitles=[],g.auctionEntries=[];var h=new PouchDB("todos"),i=new PouchDB("https://desimeentsteryingespelte:428b3ecba6fcddf3536a9776726431b6a3a89d40@ianmcloughlin.cloudant.com/auctions");g.regex="d{2}:d{2}",f(),g.addEntry=function(a){a.when=a.date.substring(0,15)+" "+a.time,delete a.date,delete a.time,a._id=e(a.when),h.put(a),console.log("new entry: "+JSON.stringify(a))},g.removeEntry=function(a,b){g.auctionEntries.splice(b,1),h.remove(a)}}angular.module("allsop").controller("AuctionsCtrl",a),a.$inject=["$scope","$q","$timeout","$rootScope"]}(),angular.module("allsop").controller("NotifyCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),function(){function a(b,c,d){function e(){a.auctionTitles=[],h.allDocs({include_docs:!0,descending:!0},function(a,b){console.log("DB Change, updating list..."),f(b.rows)})}function f(b){b.forEach(function(b){"_"!=b.id.charAt(0)&&(console.log(JSON.stringify(b.id)),a.auctionTitles.push(b.doc.where),g.push(b))})}a.auctionTitles=[];var g=[],h=new PouchDB("todos"),i=new PouchDB("http://localhost:5984/todos"),j={live:!0};return h.replicate.to(i,j),h.replicate.from(i,j),e(),h.changes({since:"now",live:!0}).on("change",e),{getTitles:function(){return a.auctionTitles}}}angular.module("allsop").service("auctionService",a),a.$inject=["$q","$rootScope","$timeout"]}(),angular.module("mytodoApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/auctions.html",'<h1 class="jumbotron" id="magenta">Auctions</h1> <!--<script>\n       window.newEntry = { time: \'22\' };\n   </script>--> <div class="container"> <!-- todos input --> <form role="form" ng-submit="auctions.addEntry(newEntry)" name="newEntryForm"> <div class="row"> <div class="input-group"> <div class="input-group" style="width:100%"> <div class="input-group-addon" style="width:5em">Date</div> <datepicker selector="form-control" date-format="EEE MMM dd yyyy"> <div class="input-group" style="width:101%"> <input id="date" class="form-control" placeholder="Choose a date" ng-model="newEntry.date" required> <span class="input-group-btn" style="cursor: pointer"> <i class="fa fa-lg fa-calendar"></i> </span> </div> </datepicker> </div> <div class="input-group" style="width:100%"> <div class="input-group-addon" style="width:5em">Time</div> <input id="time" type="text" ng-model="newEntry.time" placeholder="Time" class="form-control" ng-init="newEntry.time = \'10:30\'" minlength="5" maxlength="5" required> </div> <div class="input-group" style="width:100%"> <div class="input-group-addon" style="width:5em">Where</div> <input id="where" type="text" ng-model="newEntry.where" placeholder="Where" class="form-control" ng-init="newEntry.where = \'Dublin\'" minlength="3" minlength="3" required> </div> <div class="input-group" style="width:100%"> <div class="input-group-addon" style="width:5em">Info</div> <input id="info" type="text" ng-model="newEntry.info" placeholder="Information" class="form-control" ng-init="newEntry.info = \'House for sale\'" minlength="3" required> </div> <div class="input-group" style="width:100%"> <div class="input-group-addon" style="width:5em">URL</div> <input tid="url" ype="text" ng-model="newEntry.url" placeholder="URL" class="form-control" ng-init="newEntry.url = \'www.allsop.ie\'" minlength="3" required> </div> <!--<span class="input-group-btn">--> <span class="input-group-addon"> <input type="submit" class="btn btn-primary" value="Add" ng-disabled="!newEntryForm.$valid"> </span> </div> </div> </form> <br> <!--<div ui-sortable ng-model="auctions.entries ">--> <p class="input-group" ng-repeat="entry in auctions.auctionEntries" style="padding:5px 10px; cursor: move"> <input type="text" ng-model="entry.when" class="form-control"> <input type="text" ng-model="entry.where" class="form-control"> <input type="text" ng-model="entry.info" class="form-control"> <input type="text" ng-model="entry.url" class="form-control"> <span class="input-group-btn"> <button class="btn btn-danger" ng-click="auctions.removeEntry(entry, $index)" aria-label="Remove">X</button> </span> </p> <!--</div>--> </div>'),a.put("views/main.html",'<h1 class="jumbotron" id="magenta">Allsop Admin Portal</h1> <div class="container"> <p>From here you can:</p> <ul> <li>Update current auctions</li> <li>Send push notificaions</li> </ul> </div>'),a.put("views/notify.html","<p>This is the notify view.</p> <p>A form for sending push notifications will be here.</p>")}]);